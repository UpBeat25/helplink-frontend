import"../chunks/DsnmJJEf.js";import{p as St,f as p,a as t,b as zt,v as r,c as h,w,x as _,y as f,r as m,z as Z,k as c,A as dt}from"../chunks/BH8DMBu3.js";import{s as D}from"../chunks/BLVPUww8.js";import{p as Ct,c as d,i as ct}from"../chunks/v_Bvmvnk.js";import{e as ut,B as x,i as vt}from"../chunks/C8buxYmP.js";import{s as Lt}from"../chunks/DQo-XWKF.js";import{I as $t,a as jt,b as At,c as It,d as Tt,C as Vt,A as Yt,e as Ft,f as Mt}from"../chunks/DnykwcQs.js";import{S as Nt}from"../chunks/Df-IJIcg.js";import{S as Rt,M as Bt,a as Dt,b as Et,c as Ut,d as qt,e as Ht,R as Ot,X as Xt}from"../chunks/BMv-i9U5.js";import{p as I,L as _t}from"../chunks/B_QViUJN.js";import{g as Y}from"../chunks/NFEPWjS1.js";import{t as N}from"../chunks/CX5p_vU5.js";import{C as Gt}from"../chunks/Xy3KYGGv.js";var Jt=p("<!> <!> <!> <!> <!> <!>",1),Kt=p("<!> <!>",1),Qt=p("<!> <!>",1),Wt=p("<!> <!>",1),Zt=p('<div class="flex justify-end"><!></div>'),te=p('<div class="flex justify-end"><!></div>'),ee=p("<!> <!> <!>",1),se=p('<div class="flex justify-end gap-2"><!> <!></div>'),re=p('<div class="grid grid-cols-2 items-center w-full"><div class="flex-row"><div class="absolute"><a> </a> </div> <br/> <span class="text-muted-foreground text-sm"> </span></div> <!></div>'),oe=p('<!> <div class="text-sm text-muted-foreground"> </div> <!> <div class="text-sm"></div>',1),ae=p("<!> <!>",1),le=p('<div class="flex w-full flex-col gap-2 px-4"><!></div>'),ie=p('<div class="pr-3 pt-8 pl-3 font-mono"><h1 class="text-3xl mb-4"><b>Your Tasks</b></h1> <!> <!> <!></div>');function be(ft,tt){St(tt,!0);let et=Ct(tt,"records",7);const O=I.authStore.record;O||(N.error("You must be logged in"),Y("/login"));async function pt(){I.authStore.clear(),await Y("/login")}async function st(){if(!O){N.error("You must be logged in"),Y("/login");return}const u=await I.collection("tasks").getFullList({filter:`uploaded_by="${O.id}"`,sort:"-created"});for(let o of u){const v=await I.collection("status").getFullList({filter:`task="${o.id}"`,expand:"user"});o.status_list=v,o.hasAccepted=v.some(E=>E.status==="accepted")}et(u)}async function mt(u){const o=await I.collection("status").getFullList({filter:`task="${u}"`});for(let v of o)await I.collection("status").delete(v.id)}async function rt(u,o){try{await mt(u),await I.collection("tasks").delete(u),N.success(`Task ${o}`),st()}catch{N.error("Error deleting task")}}async function ot(u,o){try{await I.collection("status").update(u,{status:o}),N.success(`Volunteer ${o}`),location.reload()}catch(v){console.error(v),N.error("Unable to update status")}}st();var X=ie(),at=r(h(X),2);Nt(at,{});var lt=r(at,2);d(lt,()=>Ot,(u,o)=>{o(u,{children:(v,E)=>{var U=Qt(),q=w(U);d(q,()=>Rt,(H,F)=>{F(H,{children:(M,J)=>{x(M,{size:"icon",variant:"outline",class:"rounded-full absolute top-7 right-4","aria-label":"menu",children:(S,T)=>{Bt(S,{})},$$slots:{default:!0}})},$$slots:{default:!0}})});var G=r(q,2);d(G,()=>Dt,(H,F)=>{F(H,{children:(M,J)=>{var S=Kt(),T=w(S);d(T,()=>Et,(B,b)=>{b(B,{children:(P,z)=>{var C=Jt(),L=w(C);d(L,()=>Ut,(s,l)=>{l(s,{children:(n,j)=>{_();var $=f("MENU");t(n,$)},$$slots:{default:!0}})});var k=r(L,2);d(k,()=>qt,(s,l)=>{l(s,{children:(n,j)=>{_();var $=f("Navigate through the app using the options below.");t(n,$)},$$slots:{default:!0}})});var a=r(k,2);x(a,{variant:"outline",type:"button",onclick:()=>{Y("/home")},children:(s,l)=>{_();var n=f("Home");t(s,n)},$$slots:{default:!0}});var e=r(a,2);x(e,{variant:"outline",type:"button",onclick:()=>{Y("/upload")},children:(s,l)=>{_();var n=f("New Request");t(s,n)},$$slots:{default:!0}});var i=r(e,2);x(i,{variant:"outline",type:"button",onclick:()=>{Y("/view_tasks")},children:(s,l)=>{_();var n=f("View Tasks");t(s,n)},$$slots:{default:!0}});var y=r(i,2);x(y,{variant:"outline",type:"button",onclick:()=>{Y("/your_tasks")},children:(s,l)=>{_();var n=f("Your Tasks");t(s,n)},$$slots:{default:!0}}),t(P,C)},$$slots:{default:!0}})});var R=r(T,2);d(R,()=>Ht,(B,b)=>{b(B,{children:(P,z)=>{x(P,{variant:"outline",type:"button",class:"color-red",onclick:pt,children:(C,L)=>{_();var k=f("Logout");t(C,k)},$$slots:{default:!0}})},$$slots:{default:!0}})}),t(M,S)},$$slots:{default:!0}})}),t(v,U)},$$slots:{default:!0}})});var ht=r(lt,2);ut(ht,17,et,vt,(u,o)=>{var v=le(),E=h(v);d(E,()=>Mt,(U,q)=>{q(U,{class:"w-full max-w-sm mx-auto space-y-2",children:(G,H)=>{var F=ae(),M=w(F);d(M,()=>$t,(S,T)=>{T(S,{variant:"outline",children:(R,B)=>{var b=ee(),P=w(b);d(P,()=>jt,(a,e)=>{e(a,{children:(i,y)=>{var s=Wt(),l=w(s);d(l,()=>At,(j,$)=>{$(j,{children:(A,V)=>{_();var g=f();Z(()=>D(g,c(o).title)),t(A,g)},$$slots:{default:!0}})});var n=r(l,2);d(n,()=>It,(j,$)=>{$(j,{children:(A,V)=>{_();var g=f("View Volunteers");t(A,g)},$$slots:{default:!0}})}),t(i,s)},$$slots:{default:!0}})});var z=r(P,2);{var C=a=>{var e=Zt(),i=h(e);x(i,{variant:"destructive",onclick:()=>rt(c(o).id,"deleted"),children:(y,s)=>{_();var l=f("Delete Task");t(y,l)},$$slots:{default:!0}}),m(e),t(a,e)},L=a=>{var e=te(),i=h(e);x(i,{onclick:()=>rt(c(o).id,"completed"),children:(y,s)=>{_();var l=f("Completed");t(y,l)},$$slots:{default:!0}}),m(e),t(a,e)};ct(z,a=>{c(o).hasAccepted?a(L,!1):a(C)})}var k=r(z,2);d(k,()=>Tt,(a,e)=>{e(a,{children:(i,y)=>{var s=dt(),l=w(s);d(l,()=>Vt,(n,j)=>{j(n,{children:($,A)=>{x($,{size:"icon",variant:"outline",class:"rounded-full",children:(V,g)=>{Yt(V,{})},$$slots:{default:!0}})},$$slots:{default:!0}})}),t(i,s)},$$slots:{default:!0}})}),t(R,b)},$$slots:{default:!0}})});var J=r(M,2);d(J,()=>Ft,(S,T)=>{T(S,{class:"space-y-2 rounded-md border px-4 py-3 font-mono w-full",children:(R,B)=>{var b=oe(),P=w(b);_t(P,{children:(a,e)=>{_();var i=f("Description:");t(a,i)},$$slots:{default:!0}});var z=r(P,2),C=h(z,!0);m(z);var L=r(z,2);_t(L,{class:"text-sm",children:(a,e)=>{_();var i=f("Volunteers:");t(a,i)},$$slots:{default:!0}});var k=r(L,2);ut(k,21,()=>c(o).status_list,vt,(a,e)=>{var i=dt(),y=w(i);d(y,()=>$t,(s,l)=>{l(s,{variant:"outline",class:"p-3 rounded-xl",children:(n,j)=>{var $=re(),A=h($),V=h(A),g=h(V),xt=h(g,!0);m(g);var gt=r(g);m(V);var it=r(V,4),bt=h(it);m(it),m(A);var Pt=r(A,2);{var kt=K=>{var Q=se(),nt=h(Q);x(nt,{variant:"secondary",size:"icon",class:"size-8",onclick:()=>ot(c(e).id,"accepted"),children:(W,wt)=>{Gt(W,{color:"#00ff6e"})},$$slots:{default:!0}});var yt=r(nt,2);x(yt,{variant:"secondary",size:"icon",class:"size-8",onclick:()=>ot(c(e).id,"rejected"),children:(W,wt)=>{Xt(W,{color:"red"})},$$slots:{default:!0}}),m(Q),t(K,Q)};ct(Pt,K=>{c(e).status!="accepted"&&c(e).status!="rejected"&&K(kt)})}m($),Z(()=>{Lt(g,"href","/profile/"+c(e).expand.user.username),D(xt,c(e).expand.user.username),D(gt,` â€“ ${c(e).status??""}`),D(bt,`Offer: ${c(e).offer??""}`)}),t(n,$)},$$slots:{default:!0}})}),t(a,i)}),m(k),Z(()=>D(C,c(o).description)),t(R,b)},$$slots:{default:!0}})}),t(G,F)},$$slots:{default:!0}})}),m(v),t(u,v)}),m(X),t(ft,X),zt()}export{be as component};
